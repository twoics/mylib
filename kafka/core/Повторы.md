Некоторые ошибки при отправке сообщений обрабатывает сам производитель автоматически. 

	Например из за проблем с сетью

Это хорошо, так как много головной боли решается, однако тут есть риск **дублированной записи** он невелик, но все же присутствует 

Это может случиться, если потребитель отправил сообщение, оно **записалось** в брокер, но из-за проблем с сетью **ответ не пришел**, и потребитель **повторяет** запись. В результате у нас два одинаковых сообщения

Как бороться:
- Добавлять **идентификатор** в сообщения, чтобы обнаружить дубликаты при чтении
- Использовать **идемпотентную** запись (которая не влияет на результат при каждой отправке). Вместо `+10$` записать `на счете 10$` 

**Повторы чтения потребителя**
Если необходимо повторно прочитать запись `(например в случае ошибки обработки)` то есть несколько способов
- Зафиксировать последнее успешно прочитанное сообщение, и закончить обработку на данной итерации (следующая итерация начнется с ошибочной)
- Добавить проблемное сообщение в другую тему, и дальше думать что с ним делать, в зависимости от бизнес процесса

